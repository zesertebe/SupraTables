/**
 * @Description This library allows to generate a dynamic table with few lines being compatible with applications developed in Google AppScript.
 * @author: Arturo G - zesertebe@gmail.com
 * 
 * @tutorial https://ocancelada.dev/proyectos/supraTables.html
 *
 * @license Copyright (c) 2022 https://ocancelada.dev
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish and/or distribute
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */ const SUPRA_TABLES=({_mainContainer:e,_namedFunction:t,exportData:n=!0,checkElements:a=!0,setNumShowResult:l=!1,maxSpan:s=5,filterShowColumns:o=!0,numShowResult:r=50,styles:i={primaryColor:null,secondaryColor:null,primaryTextColor:null,secondaryTextColor:null,successColor:null,dangerColor:null,warningColor:null,neutralTextColor:null,neutralColor:null,primaryBgColor:null,secondaryBgColor:null},classes:c={tdStyle:null,checkInputStyle:null,spanPaginateStyle:null,spanPaginateSelectedStyle:null,spanPaginateContainerStyle:null,inputSearchStyle:null,il1:null,containerToolsTable:null,modal:null},locale:d="ES"})=>{let u={_I18N:{ES:{nullContainer:"No se encuentra el contenedor principal",indexRequired:'El argumento "index" debe ser un cadena de texto',n6:"Ning\xfan registro coincide con el criterio de b\xfasqueda",ny:"El dato esperado es un arreglo de dos dimensiones",tableAlreadyExists:'La tabla ya existe. Utilice el metodo "updateData" si desea actualizar la informaci\xf3n de su tabla.',functionOrArrIsRequired:"Debe proveer un m\xe9todo para obtener datos o un arreglo que contenga datos.",search:"Buscar",next:"Siguiente",prev:"Anterior",go:"Ir",close:"Cerrar",open:"abrir",filter:"filtrar",export:"exportar",reportCSV:"Reporte CSV",reportSheet:"Reporte EXCEL",selectAll:"Seleccionar Todo",resumeTable:(e,t,n)=>`Mostrando ${e} a ${t} de ${n} resultados`},EN:{nullContainer:"Main container not found",indexRequired:'Argument "index" must be a string',n6:"No record matches the search criteria",ny:"The expected data is a two-dimensional array",tableAlreadyExists:'The table already exists. Use the "updateData" method if you want to update the information in your table.',functionOrArrIsRequired:"You must provide a method to get data or an array containing data.",search:"Search",next:"Next",prev:"Previous",go:"Go",close:"Close",open:"open",filter:"filter",export:"export",reportCSV:"CSV report",reportSheet:"EXCEL report",selectAll:"Select All",resumeTable:(e,t,n)=>`Show ${e} to ${t} of ${n} results`},RU:{nullContainer:"Главный контейнер не найден",indexRequired:'Аргумент "индекс" должен быть строкой',n6:"Ни одна запись не соответствует критериям поиска",ny:"Ожидаемые данные представляют собой двумерный массив",tableAlreadyExists:'Таблица уже существует. Используйте метод "updateData", если вы хотите обновить информацию в вашей таблице',functionOrArrIsRequired:"Вы должны предоставить метод для получения данных или массив, содержащий данные.",search:"Поиск",next:"Следующий",prev:"Предыдущий",go:"Перейти",close:"Закрыть",open:"открыть",filter:"фильтр",export:"экспорт",reportCSV:"CSV-отчет",reportSheet:"Отчет EXCEL",selectAll:"Выбрать все",resumeTable:(e,t,n)=>`Показать ${e} - ${t} из ${n} результатов`},FR:{nullContainer:"Conteneur principal non trouv\xe9",indexRequired:'L\'argument "index" doit \xeatre une cha\xeene de caract\xe8res.',n6:"Aucun enregistrement ne correspond aux crit\xe8res de recherche",ny:"Les donn\xe9es attendues sont un tableau bidimensionnel",tableAlreadyExists:'La table existe d\xe9j\xe0. Utilisez la m\xe9thode "updateData" si vous souhaitez mettre \xe0 jour les informations de votre tableau.',functionOrArrIsRequired:"Vous devez fournir une m\xe9thode pour obtenir des donn\xe9es ou un tableau contenant des donn\xe9es.",search:"Recherche",next:"Suivant",prev:"Pr\xe9c\xe9dent",go:"Aller",close:"Fermer",open:"Ouvrir",filter:"Filtre",export:"Exportation",reportCSV:"Rapport CSV",reportSheet:"Rapport EXCEL",selectAll:"S\xe9lectionner tout",resumeTable:(e,t,n)=>`Montrant ${e} \xe0 ${t} de ${n} r\xe9sultats`}},_c4:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",_c6:62,_nulls:[null,void 0,"","undefined"],_s9:{primaryColor:"#8570EA",secondaryColor:"#F0CE97",primaryTextColor:"#9BFFD5;",secondaryTextColor:"#240046",successColor:"#45C30E",dangerColor:"#FB6A6A",warningColor:"#FBE52C",neutralTextColor:"#333",neutralColor:"#eee",primaryBgColor:"#111",secondaryBgColor:"#fff"},_classes:{}},p=void 0!=u._I18N[d]?d:"EN";if(!e instanceof HTMLElement||"string"!=typeof e)return null;if(e="string"==typeof e?document.getElementById(e):e,u._nulls.includes(e))return console.error(u._I18N[p].nullContainer),u._nulls[0];let m=`--${P()}_`,h=`z${P()}z`;var _={_gE:e=>document.getElementById(e),_isCreatedTable:!1,_v5:{},_script:null,_scriptText:"",_scriptFunction:null,_mainContainer:e,_globalData:[],_p3:[],_s2:!!o,_o3:!1,_o0:{},_y6:[],_a0:[],_n0:[],_c9:[],_p4:0,_m4:parseInt(s)>1?parseInt(s):5,_n4:parseInt(r)>1?parseInt(r):50,_n3:!!n&&!!a,_k3:!!a,_z7:!!l,_es:{_modal:E("_modal"),_modalClose:E("_modalClose"),_mc:E("_mc"),_bv:E("_bv"),_bt:E("_bt"),_m7:E("_m7"),m73:E("m73"),_q4:E("_q4"),_x8:E("_x8"),_f1:E("_f1"),_d9:E("_d9"),_i3r:E("_i3r"),_t3:E("_t3"),_i3:E("_i3"),_t3:E("_t3"),p8:E("p8"),_h7:E("_h7"),_a8:E("_a8"),_t4:E("_t4"),_f0:E("_f0"),_v4:E("_v4"),_u0:E("_u0"),_r6:E("_r6"),_c3:E("_c3"),_p2:E("_p2"),_i8:E("_i8"),bs3:E("bs3"),_re:E("_re"),_h1:E("_h1"),_z7:E("__z7")},_s9:{pc:`var(${m}primaryColor)`,sc:`var(${m}secondaryColor)`,ptc:`var(${m}primaryTextColor)`,stc:`var(${m}secondaryTextColor)`,ssc:`var(${m}successColor)`,dc:`var(${m}dangerColor)`,wc:`var(${m}warningColor)`,ntc:`var(${m}neutralTextColor)`,nc:`var(${m}neutralColor)`,pbc:`var(${m}primaryBgColor)`,sbc:`var(${m}secondaryBgColor)`,isDisabled:m+"isDisabled",isHidden:m+"isHidden",showModal:m+"showModal"},_icons(e,t,n,a){let l="";switch(e){case"ARROW_UP":l='<path d="M18 15a1 1 0 0 1-.64-.23L12 10.29l-5.37 4.32a1 1 0 0 1-1.41-.15 1 1 0 0 1 .15-1.41l6-4.83a1 1 0 0 1 1.27 0l6 5a1 1 0 0 1 .13 1.41A1 1 0 0 1 18 15z" data-name="arrow-ios-upward"></path>';break;case"ARROW_DOWN":l='<path d="M12 16a1 1 0 0 1-.64-.23l-6-5a1 1 0 1 1 1.28-1.54L12 13.71l5.36-4.32a1 1 0 0 1 1.41.15 1 1 0 0 1-.14 1.46l-6 4.83A1 1 0 0 1 12 16z" data-name="arrow-ios-downward"></path>';break;case"CSV":l='<path fill="none" stroke="#000" stroke-width="2" d="M4.99787498,8.99999999 L4.99787498,0.999999992 L19.4999998,0.999999992 L22.9999998,4.50000005 L23,23 L4,23 M18,1 L18,6 L23,6 M7,13 C7,13 6.00000004,13 5,13 C3.99999996,13 3,13.5 3,14.5 L3,16 C3,16 3.00000001,16.5 3,17.5 C2.99999999,18.5 4,19 5,19 L7,19 M13.25,13 C13.25,13 12.25,13 10.75,13 C9.25,13 8.75,13.5 8.75,14.5 C8.75,15.5 9.25,16 10.75,16 C12.25,16 12.75,16.5 12.75,17.5 C12.75,18.5 12.25,19 10.75,19 C9.25,19 8.25,19 8.25,19 M20.5,12 C20.5,12 20.5,12 20.5,12.5 C20.5,13 18,19 18,19 L17.5,19 C17.5,19 15,13 15,12.5 L15,12"></path>';break;case"PDF":l='<path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"></path>';break;case"EXCEL":l='<path xmlns="http://www.w3.org/2000/svg" d="M854.6 288.6 639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0 0 42 42h216v494zM514.1 580.1l-61.8-102.4c-2.2-3.6-6.1-5.8-10.3-5.8h-38.4c-2.3 0-4.5.6-6.4 1.9-5.6 3.5-7.3 10.9-3.7 16.6l82.3 130.4-83.4 132.8a12.04 12.04 0 0 0 10.2 18.4h34.5c4.2 0 8-2.2 10.2-5.7L510 664.8l62.3 101.4c2.2 3.6 6.1 5.7 10.2 5.7H620c2.3 0 4.5-.7 6.5-1.9 5.6-3.6 7.2-11 3.6-16.6l-84-130.4 85.3-132.5a12.04 12.04 0 0 0-10.1-18.5h-35.7c-4.2 0-8.1 2.2-10.3 5.8l-61.2 102.3z"></path>';break;case"FILTER":l='<path d="M14.037,20.937a1.015,1.015,0,0,1-.518-.145l-3.334-2a2.551,2.551,0,0,1-1.233-2.176V12.091a1.526,1.526,0,0,0-.284-.891L4.013,4.658a1.01,1.01,0,0,1,.822-1.6h14.33a1.009,1.009,0,0,1,.822,1.6h0L15.332,11.2a1.527,1.527,0,0,0-.285.891v7.834a1.013,1.013,0,0,1-1.01,1.012ZM4.835,4.063,9.482,10.62a2.515,2.515,0,0,1,.47,1.471v4.524a1.543,1.543,0,0,0,.747,1.318l3.334,2,.014-7.843a2.516,2.516,0,0,1,.471-1.471l4.654-6.542,0,0Z"></path>';break;case"EXPORT":l='<path xmlns="http://www.w3.org/2000/svg" d="M8.71 7.71 11 5.41V15a1 1 0 0 0 2 0V5.41l2.29 2.3a1 1 0 0 0 1.42 0 1 1 0 0 0 0-1.42l-4-4a1 1 0 0 0-.33-.21 1 1 0 0 0-.76 0 1 1 0 0 0-.33.21l-4 4a1 1 0 1 0 1.42 1.42zM21 14a1 1 0 0 0-1 1v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-4a1 1 0 0 0-2 0v4a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-4a1 1 0 0 0-1-1z"></path>';break;default:l='<path d="M11 16h2V7h3l-4-5-4 5h3z"></path><path d="M5 22h14c1.103 0 2-.897 2-2v-9c0-1.103-.897-2-2-2h-4v2h4v9H5v-9h4V9H5c-1.103 0-2 .897-2 2v9c0 1.103.897 2 2 2z"></path>'}return`<svg viewBox="0 0 25 25" height="${a}" width="${n}" fill="${t}">${l}</svg>`}};u._classes[m+"tdStyle"]=`.${m}tdStyle{padding: 5px 0; transition: .5s; border-right: none; font-size: 14px; color: ${_._s9.stc};}`,u._classes[m+"trStyle"]=`.${m}trStyle{transition: .5s; border-bottom: .1rem solid ${_._s9.stc}; color: ${_._s9.stc};} .${m}trStyle:hover{border-bottom-width: 3px;}`,u._classes[m+"checkInputStyle"]=`.${m}checkInputStyle{color: ${_._s9.ptc}; display: flex; justify-content: center;}`,u._classes[m+"spanPaginateStyle"]=`.${m}spanPaginateStyle{position: relative;cursor: pointer;border: none;color: ${_._s9.pc};background-color: ${_._s9.sc};border-radius: 50%;width: 20px;margin: 0 4px;height: 20px;outline: none;}`,u._classes[m+"spanPaginateSelectedStyle"]=`.${m}spanPaginateSelectedStyle{font-weight: bold; border: 2px solid ${_._s9.pc};} `,u._classes[m+"spanPaginateContainerStyle"]=`.${m}spanPaginateContainerStyle{} .${m}spanPaginateContainerStyle:after{content: '';position: absolute;border: 1px solid ${_._s9.sc};width: inherit;height: inherit;padding: 65%;top: calc(calc(-100% / 7) - 5%);left: calc(calc(-100% / 6.4705) - 4%);border-radius: 50%;}`,u._classes[m+"tablePaginate"]=`.${m}tablePaginate{width: 100%;display: flex;justify-content: space-evenly;flex-direction: row;align-items: center;}`,u._classes[m+"showModal"]=`.${m}showModal {visibility: visible !important;opacity: 1 !important;}`,u._classes[m+"isHidden"]=`.${m}isHidden {pointer-events: none !important; display:none !important;}`,u._classes[m+"isDisabled"]=`.${m}isDisabled {pointer-events: none !important;filter: blur(1.5rem);}`,u._classes[m+"inputSearchStyle"]=`.${m}inputSearchStyle {height: 100%; margin-right: 2rem; padding: 10px; border-radius: 50px; border: 1px solid #707070;}`,u._classes[m+"containerToolsTable"]=`.${m}containerToolsTable {text-align: center;display: flex;flex-direction: row;align-items: center; position: sticky;top: 0;height: auto; width: auto;background: transparent;backdrop-filter: blur(3px);}`,u._classes[m+"il1"]=`.${m}il1 {left: 8px;position: absolute;top: 0;opacity: 0;transition: all 200ms;} .input_float:not(:placeholder-shown)+.input_float__label {background: none;transform: translate(0, -70%);opacity: 1;color: #111;font-weight: 800;}`,u._classes[m+"table"]=`.${m}table{width: 100%;border-collapse: collapse;}`,u._classes[m+"selectNumShowResult"]=`.${m}selectNumShowResult {border-radius: 50px; padding: 3px; margin-right: 1rem; color: ${_._s9.ptc}; background: ${_._s9.pc};}`,u._classes[m+"formCheck"]=`.${m}formCheck{display: grid;grid-template-columns: 1fr 2fr;grid-gap: 10px;}`,u._classes[m+"buttonDanger"]=`.${m}buttonDanger{background: ${_._s9.dc}; color: ${_._s9.ntc}; }`,u._classes[m+"buttonSecondary"]=`.${m}buttonSecondary{background: ${_._s9.sc}; color: ${_._s9.pc}; }`,u._classes[m+"buttonPrimary"]=`.${m}buttonPrimary{background: ${_._s9.pc}; color: ${_._s9.ptc}; }`,u._classes[m+"resumeTable"]=`.${m}resumeTable{color: ${_._s9.stc}}`,u._classes[m+"floatChildRight"]=`.${m}floatChildRight {position: absolute;top: 0%;right: 100%;width: fit-content;padding: 0;height: auto;max-height: 50vh;overflow-y: auto;background: ${_._s9.ntc};color: ${_._s9.nc};border: 1px solid;z-index: 100000;}`,u._classes[m+"stepper"]=`.${m}stepper{    display: grid;grid-template-rows: 1fr;grid-template-columns: 1fr 1fr;grid-gap: 0;}`,u._classes[m+"button"]=`.${m}button{font-size: 14px;font-family: Roboto Condensed;font-style: Bold;line-height: 20px;border-radius: 50px;word-spacing: 10px;display: flex;column-gap: 8px;justify-content: space-around;align-items: center;border: none;padding: 8px 16px;cursor: pointer;transition: .5s;font-weight: 700; }.${m}button:hover{transform: scale(1.06);}`,u._classes[m+"thead"]=`.${m}thead{background: ${_._s9.pc}; color: ${_._s9.ptc};} .${m}thead tr td{padding: 10px;}`,u._classes[m+"modal"]=`.${m}modal {position: relative;  visibility: hidden;opacity: 0;transition: visibility .4s, opacity 0.4s linear; display: block;position: fixed;z-index: 100;padding-top: 100px;left:0;top: 0;width:100%;height: 100%;overflow: auto;background-color: rgb(0,0,0);background-color: rgba(0,0,0,0.4);}.${m}modal-content {background: ${_._s9.nc}; color: ${_._s9.ntc};border-radius:0.3rem; margin: auto;padding: 5px;border: 1px solid #888;width: 50%; position: relative;}.${m}modalClose{color: #aaaaaa;float: right;font-size: 28px;font-weight: bold;position: absolute;top: 8px;right: 8px;}.${m}modalClose:hover, .${m}modalClose:focus {color: #000;text-decoration: none;cursor: pointer;}`,_._classes=Object.keys(u._classes).map(e=>u._nulls.includes(c[e])?`${u._classes[e]}`:"").join(" "),_._root=`*{letter-spacing: 1px;} :root{ ${Object.keys(u._s9).map(e=>`${m+e}: ${u._nulls.includes(i[e])?"#"==u._s9[e][0]?u._s9[e]:"":-1!=i[e].search("--")?`var(${i[e]})`:i[e]};`).join("")} }`,_._s9.tds=c.tdStyle??m+"tdStyle",_._s9.trs=c.tdStyle??m+"trStyle",_._s9.rt=c.tdStyle??m+"resumeTable",_._s9.ci=c.checkInputStyle??m+"checkInputStyle",_._s9.sps=c.spanPaginateStyle??m+"spanPaginateStyle",_._s9.spss=c.spanPaginateSelectedStyle??m+"spanPaginateSelectedStyle",_._s9.spcs=c.spanPaginateContainerStyle??m+"spanPaginateContainerStyle",_._s9.ctt=c.containerToolsTable??m+"containerToolsTable",_._s9.iss=c.inputSearchStyle??m+"inputSearchStyle",_._s9.ifl=c.il1??m+"il1",_._s9.m=c.modal??m+"modal",_._s9.ta=c.table??m+"table",_._s9.tb=c.thead??m+"thead",_._s9.tp=c.tablePaginate??m+"tablePaginate",_._s9.bt=c.button??m+"button",_._s9.bts=c.thebuttonSecondaryad??m+"buttonSecondary",_._s9.btp=c.thebuttonSecondaryad??m+"buttonPrimary",_._s9.btd=c.thebuttonSecondaryad??m+"buttonDanger",_._s9.stepper=c.thebuttonSecondaryad??m+"stepper",_._s9.formCheck=c.thebuttonSecondaryad??m+"formCheck",_._s9.snsr=c.selectNumShowResult??m+"selectNumShowResult",_._s9.floatChildRight=c.thebuttonSecondaryad??m+"floatChildRight",_._re=e=>`<p><strong id="${e}" class="${_._s9.rt}">...</strong></p>`,_._tr=(e,t)=>`<tr class="${_._s9.trs}" data-pos="${e}">${t}</tr>`,_._td=e=>`<td class="${_._s9.tds}">${e}</td>`,_._g8=e=>`<td class="${_._s9.tds}" style="color: ${_._s9.ptc}">${e}</td>`,_._h1=(e,n,a)=>`<td data-filter="${a}" data-pos="${n}" id="${h}_${_._es._h1._id}_${n}" ${_._o3?`onclick="${t}.setOrderTable(this)"`:""} class="${_._s9.tds}" style="cursor: pointer; color: ${_._s9.ptc}"> <div style="display: flex; justify-content: center; align-items: center;"> ${e} <div id="${h}_${_._es._h1._id}_${n}_icon" style="width: fit-content; margin-left: 4px;"> ${_._o3?_._icons("ARROW_UP",_._s9.ptc,16,16):""} </div></div> </td>`,_._spanPaginate=e=>`<span class="${_._s9.sps}" id="${h}spanPaginate_${e}" onclick="${t}.createTableFiles(${e}, this)"><div class="${_._s9.spcs}">${e+1}</div></span>`,_._spanPaginateSelected=e=>`<span class="${_._s9.sps} ${_._s9.spss}" id="${h}spanPaginate_${e}" onclick="${t}.createTableFiles(${e}, this)"><div class="${_._s9.spcs}">${e+1}</div></span>`,_._checkItems=(e,n="")=>`<div class="${_._s9.ci}">${n}<input type="checkbox" value=""  id="${e}" onchange="${t}.updateSelectedItems(this)"></div>`,_._table=e=>`<table class="${_._s9.ta}" id="${_._es._m7._id}"><thead class="${_._s9.tb}" style="text-align: center;top: 0;position: sticky; font-weight: 700;" id="${_._es.m73._id}"><tr id="${_._es._v4._id}">`+e+`</tr></thead><tbody id="${_._es._f0._id}" style="text-align: center;"></tbody></table>`,_._c3=(e,n)=>`<div class="${_._s9.ctt}" id="${_._es._c3._id}">  <input type="text" id="${_._es._p2._id}" class="${_._s9.iss}" placeholder=" ${u._I18N[p].search}" onkeyup="${t}.filterTable(this)"><label class="${_._s9.ifl}">${u._I18N[p].search} </label> ${_._z7?`<select class="${_._s9.snsr}" id="${_._es._z7._id}"> ${_._globalData.length>5&&_._n4>5?'<option value="5">5</option>':""}${_._globalData.length>10&&_._n4>10?'<option value="10">10</option>':""}${_._globalData.length>20&&_._n4>20?'<option value="20">20</option>':""}${_._globalData.length>50&&_._n4>50?'<option value="50">50</option>':""}${_._globalData.length>100&&_._n4>100?'<option value="100">100</option>':""}<option selected value="${_._n4}">${_._n4}</option>${_._globalData.length-1>_._n4?`<option value="${_._globalData.length-1}">${_._globalData.length}</option>`:""}</select>`:""} <div class="" style="grid-gap: 10px;display: grid;grid-template-columns: 1fr 3fr 1fr 1fr 1fr 1fr;grid-template-rows: 1fr;width: 100%;height: 100%;align-items: center;"><section id="${_._es.p8._id}"><button id="${_._es._h7._id}" class="${_._s9.bt} ${_._s9.bts}">${e}${u._I18N[p].prev}</button></section><section id="${_._es._t3._id}" class="${_._s9.tp}"></section><section id="${_._es._a8._id}"><button id="${_._es._t4._id}" class="${_._s9.bt} ${_._s9.bts}">${u._I18N[p].next} ${n}</button></section><section id="${_._es._t3._id}"><div class="${_._s9.stepper}"><input type="number" id="${_._es._i3r._id}" class="form-control" min="1" value="1" aria-label="Recipient's username" aria-describedby="basic-addon2"><span class="" id="${_._es._i3._id}"> <button class="${_._s9.bt} ${_._s9.btp}" style="border-radius:0;">${u._I18N[p].go}</button></span></div></section> ${_._s2?`<div style="position: relative; margin: .7rem;"><button class="${_._s9.bt} ${_._s9.btp}" id="${_._es.bs3._id}" >${_._icons("FILTER",_._s9.ptc,"16","16")}</button><div class="${_._s9.floatChildRight} ${_._s9.isHidden}" id="${_._es._i8._id}"></div></div>`:""} ${_._n3?`<section><button class="${_._s9.bt} ${_._s9.btp}" id="${_._es._d9._id}"> ${_._icons("EXPORT",_._s9.ptc,"16","16")} ${u._I18N[p].export}<span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="${_._es._x8._id}"></span></button></section>`:""}</div></div>`,_._l8=(e,n)=>`<li style="list-style: none; border-bottom: 1px solid; margin: .5rem 0;"><div class="${_._s9.formCheck}"><input class="form-check-input" onchange="${t}.setTheadColumns()" type="checkbox" value="" id="${_._es._q4._id}_${e}" ${_._c9.includes(e)?"checked":""}><label class="form-check-label" for="${_._es._q4._id}_${e}">${void 0!=_._n0[_._c9.indexOf(e)]?_._n0[_._c9.indexOf(e)]:n}</label></div></li>`,_._modal=(e,t,n,a,l)=>`<div id="${e}" class="${_._s9.m}"><div class="${_._s9.m}-content"><h3 style="text-align: center; ">${u._I18N[p].export.toUpperCase()}</h3><hr> <span class="${_._s9.m}Close" id="${t}">&times;</span><p style="display: flex;flex-direction:row;justify-content: space-around; align-items: center;"><button id="${n}" class="${_._s9.bt} ${_._s9.bts}"> ${u._I18N[p].reportCSV}</button><button id="${a}" class="${_._s9.bt} ${_._s9.bts}"> ${u._I18N[p].reportSheet}</button></p><p style="display: flex;justify-content: end;padding: 0 20px;"><button id="${l}" class="${_._s9.bt} ${_._s9.btd}">${u._I18N[p].close}</button></p></div></div>`,_._mainContainer.insertAdjacentHTML("beforebegin",`<style>${_._root} ${_._classes}</style>`);let $=(e,t)=>{let n,a=[];switch(e){case"CSV":n=e=>{(a=[]).push(_._globalData[0].filter((e,t)=>_._y6.includes(t))),Object.keys(_._v5).forEach(e=>a.push(_._v5[e]));let t=[];a.forEach(function(e,n){let a=e.join(";");t.push(a)});let n=t.join("\n"),l=document.createElement("a");l.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(n)),l.setAttribute("download",u._I18N[p].reportCSV+".csv"),l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l)};break;case"SHEET":n=e=>{(a=[]).push(_._globalData[0].filter((_e,t)=>_._y6.includes(t))),Object.keys(_._v5).forEach(e=>a.push(_._v5[e]));let t="";a.forEach(function(e,n){e.forEach(function(e,n){t+=e+","}),t+="\r\n"});let n=document.createElement("a");n.setAttribute("href","data:application/vnd.ms-excel;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",u._I18N[p].reportSheet),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}}return _._gE(t).addEventListener("click",e=>{n(e)})},g=e=>{if(""===e)return null;let t=RegExp(e.value.toLowerCase()),n=!1,a="",l=[];_._p3=[],_._globalData.forEach((e,s)=>{0!=s&&(n=!1,e.forEach((e,l)=>{_._c9.includes(l)&&(!n&&t.test(String(e).toLowerCase())&&(n=!0),a+=_._td(e))}),a+=f(e,s),_._k3&&(a+=_._td(_._checkItems(`${h}reportTbodyCheck_${s}`))),a=_._tr(s,a),n&&l.push(a),a="",l.length>=_._n4&&(_._p3.push([].concat(l)),l=[]))}),l.length&&_._p3.push([].concat(l)),y(0),C()};function b(e){_._o0.type=!_._o0.type,_._o0.column=parseInt(e.dataset.filter),_._gE(`${e.id}_icon`).innerHTML=_._o0.type?_._icons("ARROW_UP",_._s9.ptc,16,16):_._icons("ARROW_DOWN",_._s9.ptc,16,16),y(_._p4)}function y(e,t){u._nulls.includes(t)||k(_._es._t3._id,[t],_._s9.spss,!0),_._p4=e,0!=e?_._es._h7._c3r.classList.remove(_._s9.isDisabled):_._es._h7._c3r.classList.add(_._s9.isDisabled),e==_._p3.length-1?_._es._a8._c3r.classList.add(_._s9.isDisabled):_._es._a8._c3r.classList.remove(_._s9.isDisabled),0==e&&_._es._h7._c3r.classList.add(_._s9.isDisabled);let n="";if(void 0===_._p3[e])n=u._I18N[p].n6,_._es._re._c3r.innerHTML="";else{let a=[];if(_._o3&&-1!=_._o0.column){let l=[],s="",o="";_._p3[e].forEach(e=>{o=null!=(s=e.match(/<td[^<]*<\/td>/g))&&null!=s[_._o0.column].match(/>.*<\//g)?s[_._o0.column].match(/>.*<\//g).map(e=>e.slice(1,-2)):0,l.push({html:e,value:isNaN(o)?o:parseInt(o)})}),l.sort((e,t)=>e.value>t.value?_._o0.type?1:-1:e.value<t.value?_._o0.type?-1:1:0),l.forEach(e=>{a.push(e.html)})}else a=_._p3[e];a.forEach(e=>{n+=e}),_._es._re._c3r.innerHTML=u._I18N[p].resumeTable(_._p3.slice(0,_._p4).reduce((e,t)=>e+t.length,0),_._p3.slice(0,_._p4+1).reduce((e,t)=>e+t.length,0),_._globalData.length-1)}_._es._f0._c3r.innerHTML=n}function C(){let e="";_._es._i3r._c3r.max=_._p3.length;for(let t=0;t<_._p3.length;t++){if(t<_._m4){if(!t){e+=_._spanPaginateSelected(t);continue}e+=_._spanPaginate(t);continue}t==_._p3.length-1&&(e+=`... ${_._spanPaginate(t)}`)}_._es._t3._c3r.innerHTML=e}function f(e,t){return 0!=_._a0.length?_._a0.map(n=>_._td(n.content(e,t))).join(""):""}function S(){_._p4=0;let e=_._gE("spanPaginate_"+_._p4);v(),y(_._p4,e)}function v(){let e="",t="",n=[],a=[],l="",s=_._es._v4._c3r.children.length-1;_._y6=[];for(let o=0;o<s;o++)n.push(_._es._v4._c3r.children[o]);_._k3||n.push(_._es._v4._c3r.children[s]),n.forEach(e=>{e.remove()}),_._p3=[];let r=0;if(_._s2){_._c9=[];for(var i=0;i<_._es._u0._c3r.children.length;i++)(l=_._es._u0._c3r.children[i].children[0].children[0]).checked&&(_._c9.push(i),_._y6.push(i),e+=_._h1(`${_._n0[_._c9.indexOf(l.id.split("_")[2])]??_._globalData[0][parseInt(l.id.split("_")[2])]}`,i,r),r++)}else _._globalData[0].forEach((t,n)=>{_._c9.includes(n)&&(_._y6.push(n),void 0!=_._n0[_._c9.indexOf(n)]?e+=_._h1(_._n0[_._c9.indexOf(n)],n,r):e+=_._h1(t,n,r),r++)});_._a0.length&&_._a0.forEach(t=>{e+=`${_._g8(t.name)}`}),_._globalData.forEach((e,n)=>{0!=n&&(t="",e.forEach((e,n)=>{_._y6.includes(n)&&(t+=_._td(e))}),t+=f(e,n),_._k3&&(t+=_._td(_._checkItems(`${h}reportTbodyCheck_${n}`))),t=_._tr(n,t),a.push(t),a.length>=_._n4&&(_._p3.push([].concat(a)),a=[]))}),a.length&&_._p3.push([].concat(a)),_._es._v4._c3r.insertAdjacentHTML("afterbegin",e),_._p4=0,y(0)}function T(e){return"string"!=typeof e?(console.error(u._I18N[p].indexRequired),null):(e=e.toUpperCase().match(/[A-Z]*/g).filter(e=>""!=e).join("")).length?1===e.length?e.charCodeAt(0)-64:e.split("").slice(0,2).reduce((e,t)=>(e.charCodeAt(0)-64)*26+(t.charCodeAt(0)-64)):null}let x=e=>_._globalData[e].filter((e,t)=>_._y6.includes(t)),w=e=>{let t=e.id.split("_");return u._nulls.includes(t[1])||isNaN(t[1])?null:(t=parseInt(t[1]),e.checked?_._v5[t]=x(t):delete _._v5[t],_._n3&&(_._es._x8._c3r.innerHTML=0!=Object.keys(_._v5).length?Object.keys(_._v5).length:""),!0)};function k(e,t,n,a){let l=!0;if(u._nulls.includes(e)||!t instanceof Array||!t.length||!t.every(e=>e instanceof HTMLElement||"string"==typeof e)||"string"!=typeof n||!n.length||"boolean"!=typeof a||!e instanceof HTMLElement&&"string"!=typeof e||(e="string"==typeof e?document.getElementById(e):e,t.forEach((e,n)=>{"string"==typeof e&&(t[n]=document.getElementById(e)),!t[n] instanceof HTMLElement&&(l=!1)}),!l))return null;for(let s=0;s<e.children.length;s++){if(a){e.children[s].classList.remove(n);continue}e.children[s].classList.add(n)}return a?(t.forEach(e=>{e.classList.add(n)}),!0):(t.forEach(e=>{e.classList.remove(n)}),!0)}function E(e){return{_id:e+P(4),_c3r:null,_l9:null}}function P(e=6){let t="";for(let n=0;n<e;n++)t+=u._c4.charAt(Math.floor(Math.random()*u._c6));return t}function L(e){u._nulls.includes(_._script)||_._script.remove(),_._script=document.createElement("script"),_._scriptText=`async function(args){return await new Promise(r=>{google.script.run.withSuccessHandler(r).${e}(args)})}`,_._script.appendChild(document.createTextNode(`(()=>{${t}._gt(${_._scriptText})})()`)),_._mainContainer.appendChild(_._script),_._script.remove()}async function R(e={columnsToShow:[1,2,3,4,5],columnsName:[],orderColumns:!1,aditionalColumns:[],arrData,nameFunction},...n){if(_._isCreatedTable)return console.error(u._I18N[p].tableAlreadyExists),null;if(u._nulls.includes(e.arrData)&&u._nulls.includes(e.nameFunction))return console.error(u._I18N[p].functionOrArrIsRequired),null;u._nulls.includes(e.arrData)?(L(e.nameFunction),n.length?D(await _._scriptFunction(...n)):D(await _._scriptFunction())):D(e.arrData);let a="",l="",s="",o=[];_._o3="boolean"==typeof e.orderColumns&&e.orderColumns,_._o3&&(_._o0.type=!0,_._o0.column=-1),_._c9=e.columnsToShow.map(e=>isNaN(e)?T(e)-1:parseInt(e)-1),_._a0=e.aditionalColumns??[],_._n0=e.columnsName??[],_._globalData.forEach((e,t)=>{0!=t&&(e.forEach((e,t)=>{_._c9.includes(t)&&(l+=_._td(e))}),l+=f(e,t),_._k3&&(l+=_._td(_._checkItems(`${h}reportTbodyCheck_${t}`))),l=_._tr(t,l),o.push(l),l="",o.length>=_._n4&&(_._p3.push([].concat(o)),o=[]))}),o.length&&_._p3.push([].concat(o));let r=0;_._globalData[0].forEach((e,t)=>{_._c9.includes(t)&&(void 0!=_._n0[_._c9.indexOf(t)]?s+=_._h1(_._n0[_._c9.indexOf(t)],t,r):s+=_._h1(e,t,r),r++)}),_._a0.length&&_._a0.forEach(e=>{s+=_._td(e)}),_._k3&&(s+=_._td(_._checkItems(_._es._r6._id,u._I18N[p].selectAll))),_._mainContainer.insertAdjacentHTML("beforeend",`${_._c3("","")}${_._table(s)} `);let i=document.createElement("script");return i.appendChild(document.createTextNode(`(()=>{document.getElementById('${_._es.m73._id}').style.top=(document.getElementById('${_._es._c3._id}').offsetHeight + 2) + 'px'})()`)),_._mainContainer.appendChild(i),i.remove(),Object.keys(_._es).forEach(e=>{_._es[e]._c3r=_._gE(_._es[e]._id)}),_._n3&&(_._es._d9._l9=_._es._d9._c3r.addEventListener("click",e=>{_._es._modal._c3r.classList.add(_._s9.showModal)})),_._mainContainer.insertAdjacentHTML("beforeend",_._re(_._es._re._id)),_._es._re._c3r=_._gE(_._es._re._id),y(_._p4),C(),a=`<ul style="margin: 0; padding: 1rem;" id="${_._es._u0._id}">`,_._globalData[0].forEach((e,t)=>{a+=_._l8(t,e)}),a+="</ul>",_._k3&&(_._es._r6._l9=_._es._r6._c3r.addEventListener("change",e=>{if(_._es._r6._c3r.checked){_._n3&&(_._es._x8._c3r.innerHTML=_._es._f0._c3r.children.length);for(var t=0;t<_._es._f0._c3r.children.length;t++)_._v5[_._es._f0._c3r.children[t].dataset.pos]=x(_._es._f0._c3r.children[t].dataset.pos),_._es._f0._c3r.children[t].children.length&&(_._es._f0._c3r.children[t].children[_._es._f0._c3r.children[t].children.length-1].children[0].children[0].checked=!0)}else{_._v5={},_._n3&&(_._es._x8._c3r.innerHTML="");for(var t=0;t<_._es._f0._c3r.children.length;t++)_._es._f0._c3r.children[t].children.length&&(_._es._f0._c3r.children[t].children[_._es._f0._c3r.children[t].children.length-1].children[0].children[0].checked=!1)}})),_._s2&&(_._es._i8._c3r.innerHTML=a,_._es._u0._c3r=_._gE(_._es._u0._id)),_._n3&&(_._mainContainer.insertAdjacentHTML("beforeend",_._modal(_._es._modal._id,_._es._modalClose._id,_._es._bv._id,_._es._bt._id,_._es._mc._id)),_._es._modal._c3r=_._gE(_._es._modal._id),_._es._modalClose._c3r=_._gE(_._es._modalClose._id),_._es._bv._c3r=_._gE(_._es._bv._id),_._es._bt._c3r=_._gE(_._es._bt._id),_._es._mc._c3r=_._gE(_._es._mc._id),_._es._modalClose._l9=_._es._modalClose._c3r.addEventListener("click",e=>{_._es._modal._c3r.classList.remove(_._s9.showModal)}),_._es._mc._l9=_._es._mc._c3r.addEventListener("click",e=>{_._es._modal._c3r.classList.remove(_._s9.showModal)})),_._z7&&(_._es._z7._l9=_._es._z7._c3r.addEventListener("change",e=>{_._n4=parseInt(_._es._z7._c3r.value),v(),C()})),_._s2&&(_._es.bs3._l9=_._es.bs3._c3r.addEventListener("click",e=>{_._es.m73._c3r.style.zIndex=_._es._i8._c3r.classList.contains(_._s9.isHidden)?"-1":"10",_._es._i8._c3r.classList.toggle(_._s9.isHidden)})),_._es._t4._l9=_._es._t4._c3r.addEventListener("click",e=>{_._p4++,_._p4>=_._m4&&_._p4<_._p3.length-1?(_._es._t3._c3r.children[_._m4-1].id=`${h}spanPaginate_${_._p4}`,_._es._t3._c3r.children[_._m4-1].setAttribute("onClick",`${t}.createTableFiles(${_._p4}, this)`),_._es._t3._c3r.children[_._m4-1].innerHTML=_._p4+1):(_._p4,_._es._t3._c3r.children.length);let n=_._gE(`${h}spanPaginate_${_._p4}`);y(_._p4,n)}),_._es._h7._l9=_._es._h7._c3r.addEventListener("click",_e=>{_._p4--,_._p4>=_._m4-1&&(_._es._t3._c3r.children[_._m4-1].id=`${h}spanPaginate_${_._p4}`,_._es._t3._c3r.children[_._m4-1].dataset.paginate=_._p4,_._es._t3._c3r.children[_._m4-1].addEventListener("click",e=>{let t=parseInt(e.target.dataset.paginate);_._p4=t;let n=e.target;null!=n&&k(_._es._t3._c3r,[n],_._s9.spss,!0),t&&_._es.p8._c3r.classList.remove(_._s9.isDisabled),t||_._es.p8._c3r.classList.add(_._s9.isDisabled),t===_._p3.length-1?_._es._a8._c3r.classList.add(_._s9.isDisabled):_._es._a8._c3r.classList.remove(_._s9.isDisabled);let a="";void 0===_._p3[t]?a+=u._I18N[p].n6:_._p3[t].forEach(e=>{a+=e}),_._es._f0.innerHTML=_tempHTML}),_._es._t3._c3r.children[_._m4-1].innerHTML=_._p4+1);let t=_._gE(`${h}spanPaginate_${_._p4}`);y(_._p4,t)}),_._es._i3._l9=_._es._i3._c3r.addEventListener("click",e=>{let n=parseInt(_._es._i3r._c3r.value)-1;if(n>_._p3.length)return!1;_._p4=n,n>=_._m4+1&&(_._es._t3._c3r.children[_._m4-1].id=`${h}spanPaginate_${n}`,_._es._t3._c3r.children[_._m4-1].setAttribute("onClick",`${t}.createTableFiles(${n}, this)`),_._es._t3._c3r.children[_._m4-1].innerHTML=n+1);let a=_._gE(`${h}spanPaginate_${n}`);y(n,a)}),_._n3&&(_._es._bv._l9=$("CSV",_._es._bv._id),_._es._bt._l9=$("SHEET",_._es._bt._id)),v(),_._globalData}let N=()=>Object.freeze(_._globalData);function D(e){return e.length&&e.every(t=>t.length===e[0].length)?(_._globalData=e,e):(console.error(u._I18N[p].ny),null)}async function A(e,...t){return(u._nulls.includes(e)||L(e),t.length)?D(await _._scriptFunction(...t)):D(await _._scriptFunction())}function I(e){console.log("init..."),_._scriptFunction=e}return Object.freeze({getData:N,updateData:A,setData:D,updateSelectedItems:w,filterTable:g,createTableFiles:y,setTheadColumns:v,_gt:I,initTable:R,updateTable:S,setOrderTable:b})};